#ifndef SERVER_H
#define SERVER_H

////////////////////////////////////////////////////////////////////////////////

#include <QTcpServer>
#include <QVector>
#include <QImage>

////////////////////////////////////////////////////////////////////////////////

class Server : public QTcpServer
{
////////////////////////////////////////////////////////////////////////////////

    Q_OBJECT

////////////////////////////////////////////////////////////////////////////////

public:

////////////////////////////////////////////////////////////////////////////////


    /* Constructor */
    Server(QObject* _parent = 0);


    /* Set image for masking */
    void SetImage(QImage* _image);


////////////////////////////////////////////////////////////////////////////////

protected:

////////////////////////////////////////////////////////////////////////////////


    /* QTcpServer interface implementation */
    void incomingConnection(int socketDescriptor);


////////////////////////////////////////////////////////////////////////////////

private slots:

////////////////////////////////////////////////////////////////////////////////


    /** Processes the incoming client connection */
    void ViewMaskedImage();

////////////////////////////////////////////////////////////////////////////////

signals:

////////////////////////////////////////////////////////////////////////////////


    /** Sends signal to GUI */
    void ImageChanged();


////////////////////////////////////////////////////////////////////////////////

private:

////////////////////////////////////////////////////////////////////////////////


    /** Image that is being processed */
    QImage* m_Image;


    /** Red part of image */
    QVector<int> m_Red;


    /** Green part of image */
    QVector<int> m_Green;


    /** Blue part of image */
    QVector<int> m_Blue;


    /** Mask */
    QVector<int> m_Mask;


    /** Number of connected clients */
    int m_ConnectedClients;


////////////////////////////////////////////////////////////////////////////////
};


#endif // SERVER_H
